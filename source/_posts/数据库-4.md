---
title: æ•°æ®åº“-4
date: 2024-12-20 09:55:54
tags:
    - å­¦ä¹ ç¬”è®°
---

## å…³ç³»å‹æ•°æ®åº“çš„ç»“æ„(è¯­æ³•)

### å…³ç³»å‹æ•°æ®åº“åŸºç¡€ä»‹ç»

å…³ç³»å‹æ•°æ®åº“ç”±ä¸€ç³»åˆ—è¡¨çš„é›†åˆç»„æˆã€‚å¯¹äºå…³ç³»æ¨¡å‹ï¼š

- $A_1, A_2,..., A_n$ä¸ºæ¨¡å‹ä¸­çš„å±æ€§
- $D_1, D_2,..., D_n$ä¸ºæ¨¡å‹ä¸­å±æ€§çš„åŸŸï¼Œå³å¯¹äºæ¯ä¸ªå±æ€§å…è®¸çš„å–å€¼ã€‚
  - å±æ€§çš„åŸŸæ˜¯ä¸€ç³»åˆ—å…è®¸çš„å€¼çš„é›†åˆ
  - å±æ€§å€¼é€šå¸¸æ˜¯åŸå­çš„ï¼Œå³ä¸å¯å†åˆ†çš„ï¼Œç¬¦åˆç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰
  - ç‰¹æ®Šå€¼`NULL`æ˜¯æ¯ä¸ªåŸŸçš„æˆå‘˜ï¼Œè¡¨ç¤ºè¯¥å€¼æœªçŸ¥ã€‚ä½†æ˜¯`NULL`çš„æ“ä½œå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æœªçŸ¥é”™è¯¯ï¼Œæ¯”å¦‚ç´¢å¼•å¤±è´¥
- $R=(A_1, A_2,..., A_n)$æ˜¯å…³ç³»æ¨¡å¼(relation schema)
- å…³ç³»å®ä¾‹`r`åœ¨æ¨¡å¼`R`ä¸Šçš„å®šä¹‰è¡¨ç¤ºä¸º$r(R)$
- å…¶å½“å‰çš„å€¼ç”±è¡¨æŒ‡å®š
- å¯¹äºå…³ç³»å®ä¾‹`r`çš„çš„ä¸€ä¸ªå…ƒç´ `t`è¢«ç§°ä¸ºå…ƒç»„(tuple)ï¼Œç”¨è¡¨ä¸­çš„ä¸€è¡Œè¡¨ç¤º
  
æˆ–è®¸æ„Ÿè§‰å¯¹äº`r`ã€`R`å’Œ`t`çš„å…³ç³»æœ‰ä¸€å®šçš„ä¸æ˜ç¡®ã€‚ç®€å•çš„æ¥è¯´ï¼Œ`R`å®šä¹‰äº†ä¸€ä¸ªè¡¨çš„ç»“æ„ï¼Œ`r`æ˜¯å¯¹äºè¡¨ç»“æ„`R`çš„å…·ä½“å®ç°ï¼Œè€Œ`t`æ˜¯`r`ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¡¨ä¸­çš„ä¸€æ¡æ•°æ®ã€‚

å¯¹äºå…³ç³»é¡ºåºä¸€èˆ¬æ˜¯æ— å…³çš„ï¼Œè¿™ä¸ªæ— å…³ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š

1. å¯¹äºè¡¨ä¸­å­˜å‚¨çš„**å±æ€§**ï¼Œå…¶æ’åˆ—é¡ºåºæ— å…³ã€‚å³$(A_1, A_2,..., A_n) = (A_2, A_1,..., A_n)$
2. å¯¹äºè¡¨ä¸­å­˜å‚¨çš„**æ•°æ®**ï¼Œå…¶æ’åˆ—é¡ºåºæ— å…³ã€‚

**æ•°æ®åº“æ¶æ„**(Database schema)æ˜¯æ•°æ®åº“çš„é€»è¾‘ç»“æ„
**æ•°æ®åº“å®ä¾‹**(Database instance)æ˜¯æ•°æ®åº“ä¸­æŸä¸€ç‰¹å®šæ—¶åˆ»çš„æ•°æ®å¿«ç…§(snapshot)ã€‚

ä¸¾ä¾‹å¦‚ä¸‹:

- æ•°æ®åº“æ¶æ„ï¼šinstructor (ID, name, dept_name, salary)
- æ•°æ®åº“ç¤ºä¾‹ï¼š![æ•°æ®åº“å®ä¾‹](/img/æ•°æ®åº“(4)/æ•°æ®åº“å®ä¾‹.png)


### å…³ç³»å‹æ•°æ®åº“çš„é”®

å…³ç³»å‹æ•°æ®åº“ä¸­å­˜åœ¨ä¸€äº›ç‰¹æ®Šçš„é”®ï¼ŒåŒ…æ‹¬æœ‰ä¸»é”®ã€ä¾¯é€‰é”®å’Œå¤–é”®

- **ä¸»é”®**æ˜¯ç”¨äºå”¯ä¸€æ ‡è¯†è¡¨ä¸­æ¯ä¸€æ¡è®°å½•çš„ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§ï¼ˆåˆ—ï¼‰çš„ç»„åˆã€‚ä¸»é”®çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ä¸ºç©ºï¼ˆå³ NOT NULLï¼‰
  - **å”¯ä¸€æ€§**ï¼šæ¯ä¸ªä¸»é”®å€¼åœ¨è¡¨ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½é‡å¤ã€‚
  - **éç©ºæ€§**ï¼šä¸»é”®åˆ—ä¸èƒ½åŒ…å« NULL å€¼ï¼Œç¡®ä¿æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„æ ‡è¯†ã€‚
  - **ç¨³å®šæ€§**ï¼šä¸»é”®çš„å€¼åº”å°½é‡ä¿æŒä¸å˜ï¼Œä»¥é¿å…æ•°æ®å¼•ç”¨æ··ä¹±ã€‚
- **å€™é€‰é”®**æ˜¯èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†è¡¨ä¸­æ¯ä¸€æ¡è®°å½•çš„ä¸€ç»„æœ€å°å±æ€§ï¼ˆåˆ—ï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œå€™é€‰é”®æ˜¯æ²¡æœ‰å†—ä½™å±æ€§çš„å€™é€‰é›†ï¼Œæ¯ä¸ªå€™é€‰é”®éƒ½æ˜¯ä¸€ä¸ªæ½œåœ¨çš„ä¸»é”®ã€‚
  - **æœ€å°æ€§**ï¼šå€™é€‰é”®ä¸­çš„æ¯ä¸ªå±æ€§éƒ½æ˜¯å¿…éœ€çš„ï¼Œå»æ‰ä»»ä½•ä¸€ä¸ªå±æ€§åï¼Œè¯¥ç»„åˆå°±ä¸å†å…·æœ‰å”¯ä¸€æ€§ã€‚
  - **å¤šæ ·æ€§**ï¼šä¸€ä¸ªè¡¨ä¸­å¯èƒ½å­˜åœ¨å¤šä¸ªå€™é€‰é”®ï¼Œä½†æœ€ç»ˆåªèƒ½é€‰æ‹©å…¶ä¸­ä¸€ä¸ªä½œä¸ºä¸»é”®ã€‚

- **å¤–é”®**æ˜¯ä¾é™„äºå…¶ä»–è¡¨çš„é”®ï¼Œå…¶æœ¬èº«ä¼šæ ¹æ®å…¶ä»–è¡¨ä¸­ç›¸åº”é”®çš„å˜åŒ–äº§ç”Ÿå˜åŒ–
  - **å‚ç…§å®Œæ•´æ€§**ï¼šå¤–é”®çš„å€¼å¿…é¡»å­˜åœ¨äºè¢«å¼•ç”¨è¡¨çš„ä¸»é”®æˆ–å”¯ä¸€é”®ä¸­ï¼Œæˆ–è€…å¯ä»¥æ˜¯ NULLï¼ˆå¦‚æœå…è®¸ï¼‰ã€‚
  - **çº¦æŸè¡Œä¸º**ï¼šå½“è¢«å¼•ç”¨è¡¨ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼ˆå¦‚åˆ é™¤æˆ–æ›´æ–°ï¼‰æ—¶ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰å¤–é”®çº¦æŸçš„è¡Œä¸ºï¼ˆå¦‚çº§è”åˆ é™¤ã€çº§è”æ›´æ–°ï¼‰æ¥è‡ªåŠ¨å¤„ç†ç›¸å…³è”çš„æ•°æ®ã€‚
  - æ•°æ®åº“è¡¨ä¹‹é—´å­˜åœ¨å¤–é”®å…³ç³»ï¼Œå¯¼å…¥æ•°æ®æ—¶ï¼Œå…ˆå¯¼å…¥è¢«å‚ç…§å…³ç³» r2 (department) ä¸­çš„æ•°æ®ï¼Œå†å¯¼å…¥å‚ç…§å…³ç³» r1 (instructor) ä¸­çš„æ•°æ®ã€‚
  - ä»»ä½•åœ¨å‚ç…§å…³ç³» r1ï¼ˆinstructorï¼‰ä¸­çš„å¤–é”®å±æ€§ï¼ˆdept_nameï¼‰å‡ºç°çš„å€¼ï¼Œå¿…é¡»è‡³å°‘åœ¨è¢«å‚ç…§å…³ç³» r2ï¼ˆdepartmentï¼‰çš„æŸä¸ªå…ƒç»„çš„å±æ€§ä¸­å­˜åœ¨ã€‚

å‚è€ƒæ•°æ®åº“æ¨¡å¼å›¾
![æ¨¡å¼å›¾](/img/æ•°æ®åº“(4)/æ¨¡å¼å›¾.png)

å¤–é”®åœ¨æ¨¡å¼å›¾ä¸­çš„è¡¨ç¤ºå¦‚ä¸‹å›¾æ‰€ç¤º
![å¤–é”®æ¨¡å¼å›¾](/img/æ•°æ®åº“(4)/å¤–é”®æ¨¡å¼å›¾.png)

## å…³ç³»æ¨¡å‹æ“ä½œ(å…³ç³»ä»£æ•°)

### Pure Languages

åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œæœ‰å‡ ç§è¯­è¨€å…¶åœ¨è¡¨è¾¾èƒ½åŠ›ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š

1. å…³ç³»ä»£æ•°ï¼ˆRelational Algebraï¼‰
2. å…ƒç»„å…³ç³»æ¼”ç®—ï¼ˆTuple Relational Calculusï¼‰
3. åŸŸå…³ç³»æ¼”ç®—ï¼ˆDomain Relational Calculusï¼‰
ä¸Šè¿°çº¯ç²¹çš„è¯­è¨€å…·æœ‰ç›¸åŒçš„è¡¨è¾¾èƒ½åŠ›ï¼Œèƒ½å¤Ÿå®Œæˆç›¸åŒç±»å‹çš„æ•°æ®æŸ¥è¯¢æ“ä½œã€‚å…¶ä¸­å…³ç³»ä»£æ•°æ˜¯å…³ç³»æ•°æ®åº“æŸ¥è¯¢å’Œæ“ä½œçš„åŸºç¡€ã€‚

### å…³ç³»ä»£æ•°çš„åŸºæœ¬æ“ä½œ

ç³»ä»£æ•°ä½œä¸ºä¸€ç§è¿‡ç¨‹å¼è¯­è¨€ï¼ŒåŒ…å«å…­ä¸ªåŸºæœ¬æ“ä½œã€‚è¿™äº›æ“ä½œæ˜¯æ„å»ºå¤æ‚æŸ¥è¯¢çš„åŸºç¡€:

- Selection         $\sigma$
- projection        $\pi$
- Cartesian Product $\times$
- Union             $\cup$
- Set Difference    $-$
- Rename            $\rho$

![ä»£æ•°å…³ç³»å¼](/img/æ•°æ®åº“(4)/ä»£æ•°å…³ç³»å¼.png)

### ä»£æ•°å…³ç³»å’Œæ•°æ®åº“è¯­è¨€çš„ç­‰ä»·æ“ä½œ

#### Select and Project Operation

å¯¹äºä»£æ•°å…³ç³»å¼
$$\sigma_p(r)$$
ç­‰ä»·äºæ•°æ®åº“è¯­è¨€
$$Select * From r Where p$$
å…¶ä¸­å¯¹äºæ¡ä»¶ç­›é€‰éƒ¨åˆ†å¯ä»¥åŒ…æ‹¬å¤§é‡çš„çš„ä¸ç­‰å¼ä»¥åŠé€»è¾‘è”ç³»ç¬¦ã€‚

- æ¯”è¾ƒ $ A = Bã€A \neq Bã€A > Bã€A < Bã€A \geq Bã€A \leq B$
- é€»è¾‘è”ç³»ç¬¦ $A \land Bã€A \lor Bã€\lnot A$

> **Example**
> $\sigma_{dept_name = "Physics" \land salary > 90000 } (instructor)$
> $\sigma_{dept_name=building}  (department)$

å¯¹äºä»£æ•°å…³ç³»å¼
$$\Pi_{A_1,A_2,...,A_N}(r)$$
ç­‰ä»·äº
$$Select A_1,A_2,...,A_N From r $$

> **Example**
> $$\Pi(\sigma_{dept_name="Physics"}(instructor))$$

#### Cartesian-Product and Join Operation

$$ A \times B $$
ç­‰ä»·äº
$$ Select * From A,B $$

è¿™ä¸ªè¿‡ç¨‹ä¸­çš„æœ¬è´¨ä¸Šæ˜¯å®ç°äº†ç¬›å¡å°”ç§¯ï¼ŒAä¸­çš„æ¯ä¸€è¡Œéƒ½ä¼šäºBä¸­çš„æ¯ä¸€è¡Œè¿›è¡Œç›¸åº”çš„åˆå¹¶ï¼ŒåŒºåˆ«äº`Join`çš„æ“ä½œï¼Œè¿™ä¸ªæ“ä½œä¸ä¼šåˆå¹¶åŒåç›¸ç­‰çš„å±æ€§ï¼Œè€Œæ˜¯åˆ†åˆ«åœ¨æ–°äº§ç”Ÿçš„è¡¨ä¸­åˆ—å‡ºã€‚å½¢å¦‚ä¸‹è¡¨æ ¼

| A.id | A.name | B.id | B.course |
|------|--------|------|----------|
| 1    | Alice  | 101  | Math     |
| 1    | Alice  | 102  | Physics  |
| 2    | Bob    | 101  | Math     |
| 2    | Bob    | 102  | Physics  |

å¯¹äº`Join`æ“ä½œ
$$ A \bowtie_{\theta} B $$
ç­‰ä»·äº
$$ \sigma_{\theta}(A \times B) $$

> **Example**
> $$\sigma_{instructor.id=teacher.id}(instructor \times teacher)$$
> equal to
> $$instructor \bowtie_{instructor.id=teacher.id} teacher$$
>
#### Unionã€ Set-Intersection and Set-Difference Operation(äº¤å¹¶é›†ç»„åˆ)

å¯¹äº`Union`æ“ä½œæ‰§è¡Œçš„è¡¨`r`å’Œ`s`ï¼Œä¸¤è€…å¿…é¡»æœ‰ç›¸åŒçš„å±æ€§æ•°é‡ï¼Œè€Œä¸”å…¶å€¼åŸŸå¿…é¡»æ˜¯å¯å¹¶ç«‹å…¼å®¹çš„ã€‚
> **Example**
> Find all courses taught in the Fall 2017 semester, or in the Spring2018 semester, or in both
> 
> $$\Pi_{course\_id}(\sigma_{semester="Fall" \land year=2017}) \cup \Pi_{course\_id}(\sigma_{semester="Spring" \land year=2018})$$


å¯¹äº`Set-Intersection`æ“ä½œæ‰§è¡Œçš„è¡¨`r`å’Œ`s`ï¼Œä¸¤è€…å¿…é¡»æœ‰ç›¸åŒçš„å±æ€§æ•°é‡ï¼Œè€Œä¸”å…¶å€¼åŸŸå¿…é¡»æ˜¯å¯å¹¶ç«‹å…¼å®¹çš„ã€‚

> **Example**
> Find all courses taught in both Fall 2017 and Spring 2018 semesters
>
> $$\Pi_{course\_id}(\sigma_{semester="Fall" \land year=2017}) \cap \Pi_{course\_id}(\sigma_{semester="Spring" \land year=2018})$$


å¯¹äº`Set-Difference`æ“ä½œæ‰§è¡Œçš„è¡¨`r`å’Œ`s`ï¼Œä¸¤è€…å¿…é¡»æœ‰ç›¸åŒçš„å±æ€§æ•°é‡ï¼Œè€Œä¸”å…¶å€¼åŸŸå¿…é¡»æ˜¯å¯å¹¶ç«‹å…¼å®¹çš„ã€‚

> **Example**
> find all courses taught in Fall 2017, but not in Spring 2018 
> $$\Pi_{course\_id}(\sigma_{semester="Fall" \land year=2017}) - \Pi_{course\_id}(\sigma_{semester="Spring" \land year=2018})$$

#### Assignment  Operation(èµ‹äºˆæ“ä½œ)

åœ¨å…³ç³»ä»£æ•°ä¸­ï¼Œèµ‹å€¼æ“ä½œç”¨äºå°†ä¸€ä¸ªå…³ç³»è¡¨è¾¾å¼çš„ç»“æœèµ‹å€¼ç»™ä¸€ä¸ªä¸´æ—¶çš„å…³ç³»åã€‚è¿™ç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„å˜é‡èµ‹å€¼ï¼Œå…è®¸ä½ ä¸ºå¤æ‚çš„æŸ¥è¯¢æ­¥éª¤å®šä¹‰ä¸­é—´ç»“æœï¼Œä»¥æé«˜æŸ¥è¯¢çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

> **Example**
> Find all instructor in Physics and Music department.
> $$ Physics \leftarrow \sigma_{dept\_name="Physics"}(instructor)$$
> $$ Music   \leftarrow \sigma_{dept\_name="Music"}(instructor)$$
> $$ Physics \cup Music $$

#### Rename Operation

å¯¹äºé‡å‘½åæœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•ã€‚

**åŸºæœ¬å½¢å¼**
$$\rho_x(E)$$
å°†å…³ç³»ä»£æ•°è¡¨è¾¾å¼ğ¸çš„ç»“æœé›†èµ‹äºˆä¸€ä¸ªæ–°çš„åç§°ğ‘¥ã€‚

**å¸¦å±æ€§é‡å‘½åçš„æ“ä½œ**
$$\rho_{x(A_1,A_2,...,A_n)}(E)$$
å°†å…³ç³»ä»£æ•°è¡¨è¾¾å¼ğ¸çš„ç»“æœé›†èµ‹äºˆä¸€ä¸ªæ–°çš„åç§°ğ‘¥å¹¶ä¸”å°†å…¶ä¸­çš„å„ä¸ªå±æ€§é‡åä¸ºä¸º$A_1,A_2,...,A_n$ã€‚

#### ç­‰ä»·

åœ¨ä»£æ•°å…³ç³»è¡¨è¾¾å¼ä¸­å­˜åœ¨ç­‰ä»·å…³ç³»ã€‚ä¸¤ä¸ªè¡¨è¾¾å¼æˆ–è®¸å†…å®¹ä¸åŒï¼Œä½†æ˜¯å…¶è¡¨è¾¾çš„å«ä¹‰ç›¸åŒï¼Œå…·æœ‰ç­‰ä»·å…³ç³»ã€‚

> **Example_1**
> Find courses taught by instructors in Physics with salary greater than 90,000
> $$\sigma_{dept\_name="Physics" \land salary>90000}(instructor)$$
> $$\sigma_{dept\_name="Physics}(\sigma_{salary>90000}(instructor))$$
>
> **Example_2**
> Find courses taught by instructors in Physics
> $$\sigma_{dept\_name="Physics"}(instructor \bowtie_{instructor.ID = teaches.ID}teacher)$$
> $$(\sigma_{dept\_name="Physics"}(instructor)) \bowtie_{instructor.ID=teacher.ID}teacher$$
