---
title: 数据库(2)
date: 2024-10-05 21:33:44
tags:
    - 学习笔记 
    - 数据库 
---
#### DML语句
DML(Data Manipulation Language)(数据库操作语言)，用于对数据库中的数据记录进行增删改操作
- 添加数据(INSERT)  在table中添加一条数据
- 修改数据(UPDATE)  对table中的数据进行修改
- 删除数据(DELETE)  对table中选定的数据进行删除
##### DML-添加数据
1. 给指定字段添加数据
   ``` INSERT INTO 表名(字段名1，字段名2，...) VALUES(值1, 值2, ...);```

2. 给全部字段添加数据
   ``` INSERT INTO 表名 VALUES(值1, 值2, ...); ```

3. 批量添加数据
   ``` INSERT INTO 表名(字段1, 字段2, ...) VALUES(值1, 值2, ...), (值1, 值2, ...),...,(值1, 值2, ...); ```
   ``` INSERT INTO 表名 VALUES(值1, 值2, ...), (值1, 值2, ...),...,(值1, 值2, ...); ```

##### DML-修改数据
``` UPDATE 修改数据 SET 字段名1 = 值1 字段名2 = 值2, ... [WHERE 条件]; ```
> **注意**：
> 修改语句的条件可以有，也可以没有，如果没有条件，则会修改整张表。

##### DML-删除数据
``` DELETE FROM 表名 [WHERE 条件] ```

> **注意：**
>   - DELETE语句的条件可以有，也可以没有，如果没有条件，则会删除整张数据表
>   - DELETE语句不能删除某一个字段的值(可以使用UPDATE)

#### DQL语句
DQL英文全称是Data Query Language(数据查询语言)，数据查询语言，用来查询数据库中表的记录。  
查询关键字: SELECT
```sql
   SELECT
      字段列表
   FROM
      表名列表
   WHERE
      条件列表
   GROUP BY 
      分组字段列表
   HAVING
      分组后条件列表
   ORDER BY
      排序字段列表
   LIMIT
      分页参数 
```
##### DQL-基本查询
1. 查询多个字段
   ```SELECT 字段1, 字段2, 字段3, ... FROM 表名```
   ```SELECT * FROM 表名 ```
2. 设置别名
   ``` SELECT 字段1 [AS 别名1], 字段2 [AS 别名2] ... FROM 表名```
3. 去除重复记录
   ```SELECT DISTINCT 字段列表 FROM 表名```
##### DQL-条件查询
1. 语法
   ``` SELECT 字段列表 FROM 表名 WHERE 条件列表;```
2. 条件
   | 比较运算符       | 功能                                      |
   | ---------------- | ----------------------------------------- |
   | $>$              | 大于                                      |
   | $>=$             | 大于等于                                  |
   | $<$              | 小于                                      |
   | $<=$             | 小于等于                                  |
   | $=$              | 等于                                      |
   | $<>$或 $!=$      | 不等于                                    |
   | BETWEEN...AND... | 在某个范围之内(含最大最小值)              |
   | IN(...)          | 在in之后列表中的值，多选一                |
   | LIKE 占位符      | 模糊匹配 (_匹配单个字符，%匹配任意个字符) |
   | IS NULL          | 是NULL                                    |
   
   | 逻辑运算符 | 功能                        |
   | ---------- | --------------------------- |
   | AND 或 &&  | 并且(多个条件同时成立)      |
   | OR 或 \|\| | 或者 (多个条件任意一个成立) |
   | NOT 或 $!$ | 非，不是                    |

##### DQL-聚合函数
1. 将一列数据作为一个整体，进行纵向计算。
2. 常见的聚合函数
   | 函数  | 功能     |
   | ----- | -------- |
   | count | 统计数量 |
   | max   | 最大值   |
   | min   | 最小值   |
   | avg   | 平均值   |
   | sum   | 求和     |
3. 语法
   ```sql
      SELECT 聚合函数(字段列表) FROM 表名;
   ```
> **注意**：
> null值不参与所有聚合函数的运算
##### DQL-分组查询
1. 语法
   `SELECT 字段列表 FROM [WHERE 条件] GROUP BY 分组字段名 [HAVING 分组之后的条件]`
2. where和having的区别
   - 执行时机不同：where是分组之前进行过滤，不满足where条件，不参与分组；而having是对分组之后的结果进行过滤。
   - 判断条件不同：where不能对聚合函数进行判断，而having可以。
   - 
> **注意**：
> - 执行顺序：where > 聚合函数 > having
> - 分组之后，查询的字段一般为聚合函数和分组字段，查询其他字段都无任何意义。 

##### DQL-排序查询
1. 语法
   `SELECT 字段列表 FROM 表名  ORDER BY 字段1 排序方式, 字段2 排序方式2; `
2. 排序方式
   - ASC：升序(默认值)
   - DESC：降序

> **注意**：如果是多字段排序，当第一个字段值相同时，才会根据第二个字段进行排序

##### DQL-分页查询
1. 语法
   `SELECT 字段列表 FROM 表名 LIMIT 起始索引, 查询记录数;`
> 注意：
> - 起始索引从0开始，起始索引=(查询页码-1)*每页显示记录数。
> - 分页查询是数据库方言，不同数据库有不同的实现，MySQL中是`LIMIT`。
> - 如果查询的是第一页数据，起始索引可以忽略，直接简写为`LIMIT 10`。

#### DCL语句
DCL英文全称是Data Control Language，用来管理数据库用户、控制数据库访问权限

 ##### DCL-管理用户
1.  查询用户
   ```sql
   USE mysql;
   SELECT * FROM user;
   ```
2.  创建用户
   ```sql
   CREATE USER '用户名'@'主机名' IDENTIFIED BY '密码'
   ```
3.  修改用户密码
   ```sql
   Alter USER  '用户名'@'主机名' IDENTIFIED WITH mysql_native_password BY '新密码'
   ```
4.  删除用户
   ```sql
   DROP USER '用户名'@'主机名'
   ```
> 注意：
> - 主机名可以使用%通配
> 这类SQL开发人员操作的比较少，主要是DBA（DataBase Administer）使用

##### DCL-权限控制
| 权限                | 说明               |
| ------------------- | ------------------ |
| ALL，ALL PRIVILEGES | 所有权限           |
| SELECT              | 查询数据           |
| INSERT              | 插入数据           |
| UPDATE              | 修改数据           |
| DELETE              | 删除数据           |
| ALTER               | 修改表             |
| DROP                | 删除数据库/表/视图 |
| GREATE              | 创建数据库/表      |
 1. 查询权限
   ```sql
   SHOW GRANTS FOR '用户名'@'主机名';
   ```
 2. 授予权限
   ```sql
   GRANT 权限列表 ON 数据库名.表名 TO '用户名'@'主机名';
   ```
 3. 撤销权限
   ```sql
   REMOVE 权限列表 ON 数据库名.表名 FROM '用户名'@'主机名';
   ```
